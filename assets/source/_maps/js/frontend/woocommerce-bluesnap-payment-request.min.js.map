{"version":3,"file":"../../../../js/frontend/woocommerce-bluesnap-payment-request.min.js","sources":["frontend/woocommerce-bluesnap-payment-request.js"],"sourcesContent":["( function ( $ ) {\n\tvar wc_bluesnap_payment_request = {\n\t\ttype: null, //\n\t\tinitialized: false,\n\t\tsession: null,\n\t\tsource: woocommerce_bluesnap_payment_request_params.request_info_source,\n\t\tgooglePayParams: {\n\t\t\tbaseRequest: {\n\t\t\t\tapiVersion: 2,\n\t\t\t\tapiVersionMinor: 0,\n\t\t\t},\n\t\t\tallowedCardNetworks: [\n\t\t\t\t'AMEX',\n\t\t\t\t'DISCOVER',\n\t\t\t\t'INTERAC',\n\t\t\t\t'JCB',\n\t\t\t\t'MASTERCARD',\n\t\t\t\t'MIR',\n\t\t\t\t'VISA',\n\t\t\t],\n\t\t\tallowedCardAuthMethods: [ 'PAN_ONLY', 'CRYPTOGRAM_3DS' ],\n\t\t},\n\n\t\tinit: function () {\n\t\t\tif ( wc_bluesnap_payment_request.initialized ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twc_bluesnap_payment_request.type = wc_bluesnap_payment_request.getSupportedPaymentRequestType();\n\n\t\t\tif ( ! wc_bluesnap_payment_request.type ) {\n\t\t\t\t// Device doesn't support any PaymentRequest method\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar cartOrCheckout = $(\n\t\t\t\t'form.woocommerce-cart-form, form.checkout, form#order_review'\n\t\t\t);\n\t\t\tif ( ! cartOrCheckout.length ) {\n\t\t\t\t// not in cart, pay order or checkout\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twc_bluesnap_payment_request.initialized = true;\n\n\t\t\tif (\n\t\t\t\twc_bluesnap_payment_request.source == 'cart' &&\n\t\t\t\t0 == woocommerce_bluesnap_payment_request_params.cart_compatible\n\t\t\t) {\n\t\t\t\twc_bluesnap_payment_request.showError(\n\t\t\t\t\t'<div class=\"woocommerce-info\">' +\n\t\t\t\t\t\twc_bluesnap_payment_request.getErrorMessage(\n\t\t\t\t\t\t\t'not_compatible_with_cart'\n\t\t\t\t\t\t) +\n\t\t\t\t\t\t'</div>'\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t! wc_bluesnap_payment_request.cartCompatibleWithCurrentType()\n\t\t\t) {\n\t\t\t\twc_bluesnap_payment_request.showError(\n\t\t\t\t\t'<div class=\"woocommerce-info\">' +\n\t\t\t\t\t\twc_bluesnap_payment_request.getErrorMessage(\n\t\t\t\t\t\t\t'device_not_compat_with_cart'\n\t\t\t\t\t\t) +\n\t\t\t\t\t\t'</div>'\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tswitch ( wc_bluesnap_payment_request.type ) {\n\t\t\t\tcase 'apple_pay':\n\t\t\t\t\twc_bluesnap_payment_request.createButton();\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'google_pay':\n\t\t\t\t\tif ( ! $( '#wc-bluesnap-google-pay-wrapper' ).length ) {\n\t\t\t\t\t\treturn; // No point going further.\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t$( '#wc-bluesnap-google-pay-wrapper.requires-account' )\n\t\t\t\t\t\t\t.length\n\t\t\t\t\t) {\n\t\t\t\t\t\t$(\n\t\t\t\t\t\t\t'#wc-bluesnap-google-pay-wrapper, #wc-bluesnap-google-pay-button-separator'\n\t\t\t\t\t\t).show();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\twc_bluesnap_payment_request.loadJS(\n\t\t\t\t\t\t'https://pay.google.com/gp/p/js/pay.js',\n\t\t\t\t\t\tfunction () {\n\t\t\t\t\t\t\twc_bluesnap_payment_request.createButton();\n\n\t\t\t\t\t\t\t$( document.body ).on(\n\t\t\t\t\t\t\t\t'updated_cart_totals',\n\t\t\t\t\t\t\t\tfunction () {\n\t\t\t\t\t\t\t\t\twc_bluesnap_payment_request.createButton();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\t\tloadJS: function ( src, callback ) {\n\t\t\tvar script = document.createElement( 'script' );\n\n\t\t\tscript.onload = function () {\n\t\t\t\tcallback();\n\t\t\t};\n\n\t\t\tscript.src = src;\n\t\t\tdocument.head.appendChild( script );\n\t\t},\n\n\t\tcreateButton: function () {\n\t\t\tswitch ( wc_bluesnap_payment_request.type ) {\n\t\t\t\tcase 'apple_pay':\n\t\t\t\t\tif ( ApplePaySession.canMakePayments() ) {\n\t\t\t\t\t\t$( '<style></style>' )\n\t\t\t\t\t\t\t.attr( 'id', 'wc-bluesnap-apple-pay-css' )\n\t\t\t\t\t\t\t.html(\n\t\t\t\t\t\t\t\t'#wc-bluesnap-apple-pay-wrapper, #wc-bluesnap-apple-pay-button-separator { display: block !important; }'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t.appendTo( 'body' );\n\n\t\t\t\t\t\t$( document ).on(\n\t\t\t\t\t\t\t'click',\n\t\t\t\t\t\t\t'#wc-bluesnap-apple-pay-wrapper a.apple-pay-button',\n\t\t\t\t\t\t\twc_bluesnap_payment_request.applePayClicked\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\twc_bluesnap_payment_request.showError(\n\t\t\t\t\t\t\t'<div class=\"woocommerce-info\">' +\n\t\t\t\t\t\t\t\twc_bluesnap_payment_request.getErrorMessage(\n\t\t\t\t\t\t\t\t\t'not_able_to_make_payments'\n\t\t\t\t\t\t\t\t) +\n\t\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'google_pay':\n\t\t\t\t\tconst paymentsClient = wc_bluesnap_payment_request.googlePayGetPaymentsClient();\n\n\t\t\t\t\tconst isReadyToPayRequest = Object.assign(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\twc_bluesnap_payment_request.googlePayParams.baseRequest,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tallowedPaymentMethods: [\n\t\t\t\t\t\t\t\twc_bluesnap_payment_request.googlePayGetBaseCardPaymentMethod(),\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tpaymentsClient\n\t\t\t\t\t\t.isReadyToPay( isReadyToPayRequest )\n\t\t\t\t\t\t.then( function ( response ) {\n\t\t\t\t\t\t\tif ( response.result ) {\n\t\t\t\t\t\t\t\t$(\n\t\t\t\t\t\t\t\t\t'#wc-bluesnap-google-pay-wrapper, #wc-bluesnap-google-pay-button-separator'\n\t\t\t\t\t\t\t\t).show();\n\n\t\t\t\t\t\t\t\twc_bluesnap_payment_request.googlePayCreateButton(\n\t\t\t\t\t\t\t\t\tpaymentsClient\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} )\n\t\t\t\t\t\t.catch( function ( err ) {\n\t\t\t\t\t\t\t// show error in developer console for debugging\n\t\t\t\t\t\t\tconsole.error( err );\n\t\t\t\t\t\t} );\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\t\tgooglePayGetCardPaymentMethod: function () {\n\t\t\tconst tokenizationSpecification = {\n\t\t\t\ttype: 'PAYMENT_GATEWAY',\n\t\t\t\tparameters: {\n\t\t\t\t\tgateway: 'bluesnap',\n\t\t\t\t\tgatewayMerchantId:\n\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params.merchant_id,\n\t\t\t\t},\n\t\t\t};\n\n\t\t\treturn Object.assign(\n\t\t\t\t{},\n\t\t\t\twc_bluesnap_payment_request.googlePayGetBaseCardPaymentMethod(),\n\t\t\t\t{\n\t\t\t\t\ttokenizationSpecification: tokenizationSpecification,\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\tgooglePayGetBaseCardPaymentMethod: function () {\n\t\t\treturn {\n\t\t\t\ttype: 'CARD',\n\t\t\t\tparameters: {\n\t\t\t\t\tallowedAuthMethods:\n\t\t\t\t\t\twc_bluesnap_payment_request.googlePayParams\n\t\t\t\t\t\t\t.allowedCardAuthMethods,\n\t\t\t\t\tallowedCardNetworks:\n\t\t\t\t\t\twc_bluesnap_payment_request.googlePayParams\n\t\t\t\t\t\t\t.allowedCardNetworks,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\n\t\tgooglePayInit: function ( paymentDataRequest ) {\n\t\t\tconst paymentsClientRequest = {\n\t\t\t\tenvironment: woocommerce_bluesnap_payment_request_params.test_mode\n\t\t\t\t\t? 'TEST'\n\t\t\t\t\t: 'PRODUCTION',\n\t\t\t\tmerchantInfo: {\n\t\t\t\t\tmerchantName:\n\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params.merchant_soft_descriptor,\n\t\t\t\t\tmerchantId:\n\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params.google_pay_merchant_id,\n\t\t\t\t},\n\t\t\t\tpaymentDataCallbacks: {\n\t\t\t\t\tonPaymentAuthorized:\n\t\t\t\t\t\twc_bluesnap_payment_request.googlePayPaymentAuthorized,\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif (\n\t\t\t\t'undefined' !== typeof paymentDataRequest &&\n\t\t\t\tpaymentDataRequest.shippingAddressRequired\n\t\t\t) {\n\t\t\t\tObject.assign( paymentsClientRequest.paymentDataCallbacks, {\n\t\t\t\t\tonPaymentDataChanged:\n\t\t\t\t\t\twc_bluesnap_payment_request.googlePayOnPaymentDataChanged,\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\treturn new google.payments.api.PaymentsClient(\n\t\t\t\tpaymentsClientRequest\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Handles dynamic buy flow shipping address and shipping options callback intents.\n\t\t *\n\t\t * @param {object} itermediatePaymentData response from Google Pay API a shipping address or shipping option is selected in the payment sheet.\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/response-objects#IntermediatePaymentData|IntermediatePaymentData object reference}\n\t\t *\n\t\t * @see {@link https://developers.google.com/pay/api/web/reference/response-objects#PaymentDataRequestUpdate|PaymentDataRequestUpdate}\n\t\t * @returns Promise<{object}> Promise of PaymentDataRequestUpdate object to update the payment sheet.\n\t\t */\n\t\tgooglePayOnPaymentDataChanged: function ( intermediatePaymentData ) {\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\t\t\t\tlet shippingAddress = intermediatePaymentData.shippingAddress;\n\t\t\t\tlet shippingOptionData =\n\t\t\t\t\tintermediatePaymentData.shippingOptionData;\n\t\t\t\tlet paymentDataRequestUpdate = {};\n\t\t\t\tlet selectedShippingOptionId = null;\n\n\t\t\t\tif (\n\t\t\t\t\t'SHIPPING_OPTION' ===\n\t\t\t\t\tintermediatePaymentData.callbackTrigger\n\t\t\t\t) {\n\t\t\t\t\tselectedShippingOptionId = shippingOptionData.id;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tpaymentDataRequestUpdate.newTransactionInfo = wc_bluesnap_payment_request.googlePayCalculateNewTransactionInfo(\n\t\t\t\t\t\tshippingAddress,\n\t\t\t\t\t\tselectedShippingOptionId\n\t\t\t\t\t);\n\n\t\t\t\t\tpaymentDataRequestUpdate.newShippingOptionParameters = wc_bluesnap_payment_request.transformShippingForGpay(\n\t\t\t\t\t\tpaymentDataRequestUpdate.newTransactionInfo\n\t\t\t\t\t\t\t.shippingMethods\n\t\t\t\t\t);\n\n\t\t\t\t\tdelete paymentDataRequestUpdate\n\t\t\t\t\t\t.newTransactionInfo.shippingMethods; // This is already in newShippingOptionParameters and leaving it here throws an error.\n\n\t\t\t\t\tresolve( paymentDataRequestUpdate );\n\t\t\t\t} catch ( error ) {\n\t\t\t\t\tif ( 'object' !== typeof error || ! error.intent ) {\n\t\t\t\t\t\terror = {\n\t\t\t\t\t\t\treason: 'OTHER_ERROR',\n\t\t\t\t\t\t\tmessage:\n\t\t\t\t\t\t\t\t'Could not get shipping information from the server',\n\t\t\t\t\t\t\tintent: 'SHIPPING_ADDRESS',\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\t// GooglePay expects a sligtly different error code in this case.\n\t\t\t\t\terror.reason =\n\t\t\t\t\t\terror.reason &&\n\t\t\t\t\t\terror.reason === 'invalid_shipping_address'\n\t\t\t\t\t\t\t? 'SHIPPING_ADDRESS_INVALID'\n\t\t\t\t\t\t\t: error.reason;\n\n\t\t\t\t\treject( error );\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\n\t\ttransformShippingForGpay: function ( shippingMethods ) {\n\t\t\tif ( ! shippingMethods || 0 === shippingMethods.length ) {\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tshippingOptions = [];\n\n\t\t\tshippingMethods.forEach( ( shippingMethod ) => {\n\t\t\t\tshippingOptions.push( {\n\t\t\t\t\tid: shippingMethod.identifier,\n\t\t\t\t\tlabel:\n\t\t\t\t\t\tshippingMethod.label +\n\t\t\t\t\t\t'(' +\n\t\t\t\t\t\tshippingMethod.amount +\n\t\t\t\t\t\t')',\n\t\t\t\t\tdescription: shippingMethod.detail,\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\treturn {\n\t\t\t\tdefaultSelectedOptionId: shippingOptions[ 0 ].id,\n\t\t\t\tshippingOptions: shippingOptions,\n\t\t\t};\n\t\t},\n\n\t\tgooglePayCalculateNewTransactionInfo: function (\n\t\t\tshippingAddress,\n\t\t\tshippingOptionId\n\t\t) {\n\t\t\tif ( null !== shippingOptionId ) {\n\t\t\t\twc_bluesnap_payment_request.updateShippingMethod( {\n\t\t\t\t\tidentifier: shippingOptionId,\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\treturn wc_bluesnap_payment_request.getShippingOptions(\n\t\t\t\tshippingAddress\n\t\t\t);\n\t\t},\n\n\t\tgooglePayGetPaymentsClient: function ( paymentDataRequest ) {\n\t\t\t/**\n\t\t\t * The output of this method is intentionally not cached\n\t\t\t * as paymentDataCallbacks may need to change depending on\n\t\t\t * the current cart's content (requires shipping or not, etc).\n\t\t\t */\n\t\t\treturn wc_bluesnap_payment_request.googlePayInit(\n\t\t\t\tpaymentDataRequest\n\t\t\t);\n\t\t},\n\n\t\tgooglePayCreateButton: function ( paymentsClient ) {\n\t\t\tconst button = paymentsClient.createButton( {\n\t\t\t\tonClick: wc_bluesnap_payment_request.googlePayClicked,\n\t\t\t} );\n\n\t\t\tdocument\n\t\t\t\t.getElementById( 'wc-bluesnap-google-pay-button-cont' )\n\t\t\t\t.appendChild( button );\n\t\t},\n\n\t\tgetSupportedPaymentRequestType: function () {\n\t\t\tif (\n\t\t\t\t'undefined' !== typeof window.ApplePaySession &&\n\t\t\t\twoocommerce_bluesnap_payment_request_params.apple_pay_enabled\n\t\t\t) {\n\t\t\t\treturn 'apple_pay';\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t'undefined' !== typeof window.PaymentRequest &&\n\t\t\t\twoocommerce_bluesnap_payment_request_params.google_pay_enabled\n\t\t\t) {\n\t\t\t\t/**\n\t\t\t\t * Note that:\n\t\t\t\t * PaymentRequest is not GooglePay, but its unlikely that a browser that supports GooglePay doesn't support PaymentRequest.\n\t\t\t\t * Any edge case where a browser does support PaymentRequest but doesn't support GooglePay will be handled by\n\t\t\t\t * paymentsClient.isReadyToPay().\n\t\t\t\t */\n\t\t\t\treturn 'google_pay';\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\tcartCompatibleWithCurrentType: function () {\n\t\t\tswitch ( wc_bluesnap_payment_request.type ) {\n\t\t\t\tcase 'apple_pay':\n\t\t\t\t\treturn (\n\t\t\t\t\t\twindow.ApplePaySession !== undefined &&\n\t\t\t\t\t\tApplePaySession.supportsVersion(\n\t\t\t\t\t\t\tparseInt(\n\t\t\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params\n\t\t\t\t\t\t\t\t\t.version_required[\n\t\t\t\t\t\t\t\t\twc_bluesnap_payment_request.type\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\tcase 'google_pay':\n\t\t\t\t\treturn true;\n\t\t\t\tdefault:\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\tgooglePayClicked: function ( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tconst paymentDataRequest = wc_bluesnap_payment_request.googlePayGetPaymentDataRequest();\n\t\t\tconst paymentsClient = wc_bluesnap_payment_request.googlePayGetPaymentsClient(\n\t\t\t\tpaymentDataRequest\n\t\t\t);\n\t\t\tpaymentsClient.loadPaymentData( paymentDataRequest ).catch( function ( err ) {\n\t\t\t\t// Catch exiting payment sheet without proceeding.\n\t\t\t});\n\t\t},\n\n\t\tgooglePayGetPaymentDataRequest: function () {\n\t\t\tvar request = wc_bluesnap_payment_request.getRequestData();\n\n\t\t\tlet paymentDataRequest = Object.assign(\n\t\t\t\t{},\n\t\t\t\twc_bluesnap_payment_request.googlePayParams.baseRequest\n\t\t\t);\n\n\t\t\tconst cardPaymentMethod = wc_bluesnap_payment_request.googlePayGetCardPaymentMethod();\n\n\t\t\tcardPaymentMethod.parameters = Object.assign(\n\t\t\t\tcardPaymentMethod.parameters,\n\t\t\t\trequest.billingAddressInfo\n\t\t\t);\n\n\t\t\tpaymentDataRequest.allowedPaymentMethods = [ cardPaymentMethod ];\n\t\t\tpaymentDataRequest.transactionInfo = request.transactionInfo;\n\t\t\tpaymentDataRequest.merchantInfo = {\n\t\t\t\tmerchantId:\n\t\t\t\t\twoocommerce_bluesnap_payment_request_params.google_pay_merchant_id,\n\t\t\t\tmerchantName:\n\t\t\t\t\twoocommerce_bluesnap_payment_request_params.merchant_soft_descriptor,\n\t\t\t};\n\n\t\t\tpaymentDataRequest = Object.assign(\n\t\t\t\tpaymentDataRequest,\n\t\t\t\trequest.shippingAddressInfo\n\t\t\t);\n\n\t\t\tpaymentDataRequest.callbackIntents = [ 'PAYMENT_AUTHORIZATION' ];\n\n\t\t\tpaymentDataRequest.shippingOptionRequired =\n\t\t\t\tpaymentDataRequest.shippingAddressRequired;\n\n\t\t\tif ( paymentDataRequest.shippingOptionRequired ) {\n\t\t\t\tpaymentDataRequest.callbackIntents = paymentDataRequest.callbackIntents.concat(\n\t\t\t\t\t[ 'SHIPPING_ADDRESS', 'SHIPPING_OPTION' ]\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tpaymentDataRequest.emailRequired = true;\n\n\t\t\treturn paymentDataRequest;\n\t\t},\n\n\t\tapplePayClicked: function ( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tif ( wc_bluesnap_payment_request.session !== null ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\twc_bluesnap_payment_request.blockForm();\n\n\t\t\tvar request = wc_bluesnap_payment_request.getRequestData();\n\n\t\t\tif ( false !== request ) {\n\t\t\t\ttry {\n\t\t\t\t\tvar apple_session = ( wc_bluesnap_payment_request.session = new ApplePaySession(\n\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params.version_required[\n\t\t\t\t\t\t\twc_bluesnap_payment_request.type\n\t\t\t\t\t\t],\n\t\t\t\t\t\trequest\n\t\t\t\t\t) );\n\t\t\t\t} catch ( error ) {\n\t\t\t\t\twc_bluesnap_payment_request.showError(\n\t\t\t\t\t\t'<div class=\"woocommerce-error\">' +\n\t\t\t\t\t\t\twc_bluesnap_payment_request.getErrorMessage(\n\t\t\t\t\t\t\t\t'device_not_compat_with_cart'\n\t\t\t\t\t\t\t) +\n\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t);\n\t\t\t\t\t$( '#wc-bluesnap-apple-pay-css' ).html(\n\t\t\t\t\t\t'#wc-bluesnap-apple-pay-wrapper, #wc-bluesnap-apple-pay-button-separator { display: none !important; }'\n\t\t\t\t\t);\n\t\t\t\t\twc_bluesnap_payment_request.unblockForm();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tapple_session.onvalidatemerchant =\n\t\t\t\t\twc_bluesnap_payment_request.applePayValidateMerchant;\n\n\t\t\t\tapple_session.onshippingcontactselected =\n\t\t\t\t\twc_bluesnap_payment_request.applePayUpdateShippingInfo;\n\n\t\t\t\tapple_session.onshippingmethodselected =\n\t\t\t\t\twc_bluesnap_payment_request.applePayUpdateShippingMethod;\n\n\t\t\t\tapple_session.onpaymentauthorized =\n\t\t\t\t\twc_bluesnap_payment_request.applePayPaymentAuthorized;\n\n\t\t\t\tapple_session.oncancel =\n\t\t\t\t\twc_bluesnap_payment_request.handleCancel;\n\n\t\t\t\tapple_session.begin();\n\t\t\t} else {\n\t\t\t\twc_bluesnap_payment_request.unblockForm();\n\t\t\t\talert(\n\t\t\t\t\t'Apple Pay could not be initialized. Try an alternate form of payment'\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\n\t\tapplePayValidateMerchant: function ( event ) {\n\t\t\t$.ajax( {\n\t\t\t\turl: wc_bluesnap_payment_request.getAjaxUrl(\n\t\t\t\t\t'create_apple_wallet'\n\t\t\t\t),\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tsecurity:\n\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params.nonces\n\t\t\t\t\t\t\t.create_apple_wallet,\n\t\t\t\t\tvalidation_url: event.validationURL,\n\t\t\t\t\tpayment_request_type: wc_bluesnap_payment_request.type,\n\t\t\t\t\tpayment_request_source: wc_bluesnap_payment_request.source,\n\t\t\t\t},\n\t\t\t} ).then( function ( res ) {\n\t\t\t\tif ( ! res.success ) {\n\t\t\t\t\twc_bluesnap_payment_request.handleError( res );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar decoded_token = window.atob( res.data.walletToken );\n\t\t\t\twc_bluesnap_payment_request.session.completeMerchantValidation(\n\t\t\t\t\tJSON.parse( decoded_token )\n\t\t\t\t);\n\t\t\t}, wc_bluesnap_payment_request.handleError );\n\t\t},\n\n\t\tgetShippingOptions: function ( address, callback ) {\n\t\t\tvar ret = false;\n\n\t\t\t$.ajax( {\n\t\t\t\turl: wc_bluesnap_payment_request.getAjaxUrl(\n\t\t\t\t\t'get_shipping_options'\n\t\t\t\t),\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tasync: 'apple_pay' === wc_bluesnap_payment_request.type,\n\t\t\t\tdata: {\n\t\t\t\t\tsecurity:\n\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params.nonces\n\t\t\t\t\t\t\t.get_shipping_options,\n\t\t\t\t\taddress: window.btoa( unescape( encodeURIComponent( ( JSON.stringify( address ) ) ) ) ),\n\t\t\t\t\tpayment_request_type: wc_bluesnap_payment_request.type,\n\t\t\t\t\tpayment_request_source: wc_bluesnap_payment_request.source,\n\t\t\t\t},\n\t\t\t} )\n\t\t\t\t.done(\n\t\t\t\t\tcallback ||\n\t\t\t\t\t\tfunction ( res ) {\n\t\t\t\t\t\t\tif ( res.success ) {\n\t\t\t\t\t\t\t\tret = res.data;\n\t\t\t\t\t\t\t} else if ( res.data && res.data.errorCode ) {\n\t\t\t\t\t\t\t\tthrow {\n\t\t\t\t\t\t\t\t\treason: res.data.errorCode,\n\t\t\t\t\t\t\t\t\tmessage: res.data.message || '',\n\t\t\t\t\t\t\t\t\tintent: 'SHIPPING_ADDRESS',\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t\t.fail( wc_bluesnap_payment_request.handleError );\n\n\t\t\treturn ret;\n\t\t},\n\n\t\tapplePayUpdateShippingInfo: function ( event ) {\n\t\t\tvar address = event.shippingContact;\n\n\t\t\twc_bluesnap_payment_request.getShippingOptions(\n\t\t\t\taddress,\n\t\t\t\tfunction ( res ) {\n\t\t\t\t\tvar data = res.data;\n\t\t\t\t\tif ( ! res.success ) {\n\t\t\t\t\t\tvar err = new ApplePayError(\n\t\t\t\t\t\t\t'shippingContactInvalid',\n\t\t\t\t\t\t\t'postalAddress',\n\t\t\t\t\t\t\tdata.message\n\t\t\t\t\t\t);\n\t\t\t\t\t\twc_bluesnap_payment_request.session.completeShippingContactSelection(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstatus: ApplePaySession.STATUS_FAILURE,\n\t\t\t\t\t\t\t\terrors: [ err ],\n\t\t\t\t\t\t\t\tnewShippingMethods: [],\n\t\t\t\t\t\t\t\tnewLineItems: data.lineItems,\n\t\t\t\t\t\t\t\tnewTotal: data.total,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\twc_bluesnap_payment_request.session.completeShippingContactSelection(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstatus: ApplePaySession.STATUS_SUCCESS,\n\t\t\t\t\t\t\tnewShippingMethods: data.shippingMethods,\n\t\t\t\t\t\t\tnewLineItems: data.lineItems,\n\t\t\t\t\t\t\tnewTotal: data.total,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\tapplePayUpdateShippingMethod: function ( event ) {\n\t\t\tvar method = event.shippingMethod;\n\n\t\t\twc_bluesnap_payment_request.updateShippingMethod(\n\t\t\t\tmethod,\n\t\t\t\tfunction ( res ) {\n\t\t\t\t\tvar data = res.data;\n\t\t\t\t\tif ( ! res.success ) {\n\t\t\t\t\t\twc_bluesnap_payment_request.session.completeShippingMethodSelection(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstatus: ApplePaySession.STATUS_FAILURE,\n\t\t\t\t\t\t\t\tnewLineItems: data.lineItems,\n\t\t\t\t\t\t\t\tnewTotal: data.total,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\twc_bluesnap_payment_request.session.completeShippingMethodSelection(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstatus: ApplePaySession.STATUS_SUCCESS,\n\t\t\t\t\t\t\tnewLineItems: data.lineItems,\n\t\t\t\t\t\t\tnewTotal: data.total,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\tupdateShippingMethod: function ( method, callback ) {\n\t\t\t$.ajax( {\n\t\t\t\turl: wc_bluesnap_payment_request.getAjaxUrl(\n\t\t\t\t\t'update_shipping_method'\n\t\t\t\t),\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tasync: 'apple_pay' === wc_bluesnap_payment_request.type,\n\t\t\t\tdata: {\n\t\t\t\t\tsecurity:\n\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params.nonces\n\t\t\t\t\t\t\t.update_shipping_method,\n\t\t\t\t\tmethod: [ method.identifier ],\n\t\t\t\t\tpayment_request_type: wc_bluesnap_payment_request.type,\n\t\t\t\t\tpayment_request_source: wc_bluesnap_payment_request.source,\n\t\t\t\t},\n\t\t\t} )\n\t\t\t\t.done( callback )\n\t\t\t\t.fail( wc_bluesnap_payment_request.handleError );\n\t\t},\n\n\t\tgooglePayPaymentAuthorized: function ( data ) {\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\t\t\t\twc_bluesnap_payment_request.paymentRequestPaymentAuthorized(\n\t\t\t\t\t{\n\t\t\t\t\t\tpayment: data,\n\t\t\t\t\t},\n\t\t\t\t\tfunction ( res ) {\n\t\t\t\t\t\tres.resolveFn = resolve;\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\ttypeof res.success !== 'undefined' &&\n\t\t\t\t\t\t\t\tfalse === res.success\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\twc_bluesnap_payment_request.handleError( res );\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ( typeof res.result !== 'undefined' ) {\n\t\t\t\t\t\t\t\twc_bluesnap_payment_request.handleWCResponse(\n\t\t\t\t\t\t\t\t\tres\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch ( error ) {\n\t\t\t\t\t\t\tdoReject( error );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfunction ( res ) {\n\t\t\t\t\t\tres.resolveFn = resolve;\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\twc_bluesnap_payment_request.handleError( res );\n\t\t\t\t\t\t} catch ( error ) {\n\t\t\t\t\t\t\tdoReject( error );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tfunction doReject( error ) {\n\t\t\t\t\tlet errorMessage;\n\n\t\t\t\t\terrorMessage =\n\t\t\t\t\t\terror && error.data && 'string' === typeof error.data\n\t\t\t\t\t\t\t? error.data\n\t\t\t\t\t\t\t: wc_bluesnap_payment_request.getErrorMessage(\n\t\t\t\t\t\t\t\t\t'checkout_error'\n\t\t\t\t\t\t\t  );\n\n\t\t\t\t\treject( {\n\t\t\t\t\t\tintent: 'PAYMENT_AUTHORIZATION',\n\t\t\t\t\t\tmessage: errorMessage,\n\t\t\t\t\t\treason: 'PAYMENT_DATA_INVALID',\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\n\t\tapplePayPaymentAuthorized: function ( data ) {\n\t\t\twc_bluesnap_payment_request.paymentRequestPaymentAuthorized(\n\t\t\t\tdata,\n\t\t\t\tfunction ( res ) {\n\t\t\t\t\tif (\n\t\t\t\t\t\ttypeof res.success !== 'undefined' &&\n\t\t\t\t\t\tfalse === res.success\n\t\t\t\t\t) {\n\t\t\t\t\t\twc_bluesnap_payment_request.handleError( res );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif ( typeof res.result !== 'undefined' ) {\n\t\t\t\t\t\twc_bluesnap_payment_request.handleWCResponse( res );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\twc_bluesnap_payment_request.handleError\n\t\t\t);\n\t\t},\n\n\t\tpaymentRequestPaymentAuthorized: function (\n\t\t\tevent,\n\t\t\tonSuccess,\n\t\t\tonError\n\t\t) {\n\t\t\tvar paymentToken = event.payment;\n\n\t\t\t$.ajax( {\n\t\t\t\turl: wc_bluesnap_payment_request.getAjaxUrl(\n\t\t\t\t\t'create_pmr_payment'\n\t\t\t\t),\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\t_wpnonce:\n\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params.nonces\n\t\t\t\t\t\t\t.checkout,\n\t\t\t\t\tpayment_token: btoa(\n\t\t\t\t\t\tencodeURIComponent(\n\t\t\t\t\t\t\tJSON.stringify( paymentToken )\n\t\t\t\t\t\t).replace(\n\t\t\t\t\t\t\t/%([0-9A-F]{2})/g,\n\t\t\t\t\t\t\tfunction toSolidBytes( match, p1 ) {\n\t\t\t\t\t\t\t\treturn String.fromCharCode( '0x' + p1 );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\t\tpayment_request_type: wc_bluesnap_payment_request.type,\n\t\t\t\t\tpayment_request_source: wc_bluesnap_payment_request.source,\n\t\t\t\t\tis_change_payment_method: woocommerce_bluesnap_payment_request_params.change_payment_page,\n\t\t\t\t},\n\t\t\t} ).then( onSuccess, onError );\n\t\t},\n\n\t\tgetAjaxUrl: function ( method ) {\n\t\t\treturn woocommerce_bluesnap_payment_request_params.wc_ajax_url\n\t\t\t\t.toString()\n\t\t\t\t.replace( '%%endpoint%%', 'bluesnap_' + method );\n\t\t},\n\n\t\tgetRequestData: function () {\n\t\t\tvar ret = false;\n\t\t\t$.ajax( {\n\t\t\t\turl: wc_bluesnap_payment_request.getAjaxUrl(\n\t\t\t\t\t'get_payment_request'\n\t\t\t\t),\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tsecurity:\n\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params.nonces\n\t\t\t\t\t\t\t.get_payment_request,\n\t\t\t\t\tpayment_request_type: wc_bluesnap_payment_request.type,\n\t\t\t\t\tpayment_request_source: wc_bluesnap_payment_request.source,\n\t\t\t\t\tis_change_payment_method:\n\t\t\t\t\t\twoocommerce_bluesnap_payment_request_params.change_payment_page,\n\t\t\t\t},\n\t\t\t\tasync: false,\n\t\t\t} )\n\t\t\t\t.done( function ( res ) {\n\t\t\t\t\tif ( res.success ) {\n\t\t\t\t\t\tret = res.data;\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t\t\t.fail( function () {} );\n\n\t\t\treturn ret;\n\t\t},\n\n\t\thandleError: function ( error ) {\n\t\t\tswitch ( wc_bluesnap_payment_request.type ) {\n\t\t\t\tcase 'apple_pay':\n\t\t\t\t\twc_bluesnap_payment_request.session.completePayment(\n\t\t\t\t\t\tApplePaySession.STATUS_FAILURE\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'google_pay':\n\t\t\t\t\tthrow error;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\twc_bluesnap_payment_request.session = null;\n\t\t\twc_bluesnap_payment_request.unblockForm();\n\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t},\n\n\t\thandleSuccess: function ( result ) {\n\t\t\tswitch ( wc_bluesnap_payment_request.type ) {\n\t\t\t\tcase 'apple_pay':\n\t\t\t\t\twc_bluesnap_payment_request.session.completePayment(\n\t\t\t\t\t\tApplePaySession.STATUS_SUCCESS\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'google_pay':\n\t\t\t\t\tif ( result && 'function' === typeof result.resolveFn ) {\n\t\t\t\t\t\tresult.resolveFn( {\n\t\t\t\t\t\t\ttransactionState: 'SUCCESS',\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\twc_bluesnap_payment_request.session = null;\n\t\t},\n\n\t\thandleCancel: function () {\n\t\t\tswitch ( wc_bluesnap_payment_request.type ) {\n\t\t\t\tcase 'apple_pay':\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\twc_bluesnap_payment_request.session = null;\n\t\t\twc_bluesnap_payment_request.unblockForm();\n\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t},\n\n\t\thandleWCResponse: function ( result ) {\n\t\t\ttry {\n\t\t\t\tif ( 'success' === result.result ) {\n\t\t\t\t\twc_bluesnap_payment_request.handleSuccess( result );\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t-1 === result.redirect.indexOf( 'https://' ) ||\n\t\t\t\t\t\t-1 === result.redirect.indexOf( 'http://' )\n\t\t\t\t\t) {\n\t\t\t\t\t\twindow.location = result.redirect;\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.location = decodeURI( result.redirect );\n\t\t\t\t\t}\n\t\t\t\t} else if ( 'failure' === result.result ) {\n\t\t\t\t\tthrow 'Result failure';\n\t\t\t\t} else {\n\t\t\t\t\tthrow 'Invalid response';\n\t\t\t\t}\n\t\t\t} catch ( err ) {\n\t\t\t\t// Reload page\n\t\t\t\tif ( true === result.reload ) {\n\t\t\t\t\twindow.location.reload();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Trigger update in case we need a fresh nonce\n\t\t\t\tif ( true === result.refresh ) {\n\t\t\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t\t\t}\n\n\t\t\t\t// Add new errors\n\t\t\t\tif ( result.messages ) {\n\t\t\t\t\twc_bluesnap_payment_request.showError( result.messages );\n\t\t\t\t} else {\n\t\t\t\t\twc_bluesnap_payment_request.showError(\n\t\t\t\t\t\t'<div class=\"woocommerce-error\">' +\n\t\t\t\t\t\t\twc_bluesnap_payment_request.getErrorMessage(\n\t\t\t\t\t\t\t\t'checkout_error'\n\t\t\t\t\t\t\t) +\n\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif ( ! 'google_pay' === wc_bluesnap_payment_request.type ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( result && 'function' === typeof result.resolveFn ) {\n\t\t\t\t\tlet errorMessage = result.messages\n\t\t\t\t\t\t? parseWCErrors( result.messages )\n\t\t\t\t\t\t: err;\n\n\t\t\t\t\tresult.resolveFn( {\n\t\t\t\t\t\ttransactionState: 'ERROR',\n\t\t\t\t\t\terror: {\n\t\t\t\t\t\t\tintent: 'PAYMENT_AUTHORIZATION',\n\t\t\t\t\t\t\tmessage: errorMessage,\n\t\t\t\t\t\t\treason: 'PAYMENT_DATA_INVALID',\n\t\t\t\t\t\t},\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\tthrow err;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseWCErrors( html ) {\n\t\t\t\tvar div = document.createElement( 'div' );\n\t\t\t\tdiv.innerHTML = html;\n\t\t\t\tvar text = div.textContent || div.innerText || '';\n\n\t\t\t\treturn text.trim();\n\t\t\t}\n\t\t},\n\n\t\tgetForm: function () {\n\t\t\tvar form = $( 'form.woocommerce-checkout' );\n\t\t\tif ( ! form.length ) {\n\t\t\t\tform = $( 'form#add_payment_method' );\n\t\t\t}\n\t\t\tif ( ! form.length ) {\n\t\t\t\tform = $( 'form#order_review' );\n\t\t\t}\n\t\t\tif ( ! form.length ) {\n\t\t\t\tform = $( 'form.woocommerce-cart-form' );\n\t\t\t\tif ( form.length ) {\n\t\t\t\t\tform = form.closest( '.woocommerce' );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn form;\n\t\t},\n\n\t\tblockForm: function () {\n\t\t\twc_bluesnap_payment_request\n\t\t\t\t.getForm()\n\t\t\t\t.addClass( 'processing' )\n\t\t\t\t.block( {\n\t\t\t\t\tmessage: null,\n\t\t\t\t\toverlayCSS: {\n\t\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\t\topacity: 0.6,\n\t\t\t\t\t},\n\t\t\t\t} );\n\t\t},\n\n\t\tunblockForm: function () {\n\t\t\twc_bluesnap_payment_request\n\t\t\t\t.getForm()\n\t\t\t\t.removeClass( 'processing' )\n\t\t\t\t.unblock();\n\t\t},\n\n\t\tshowError: function ( error_message ) {\n\t\t\tvar form = wc_bluesnap_payment_request.getForm();\n\t\t\tif ( ! form.length ) {\n\t\t\t\tconsole.error( error_message );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$(\n\t\t\t\t'.woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message'\n\t\t\t).remove();\n\t\t\tform.prepend(\n\t\t\t\t'<div class=\"woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout\">' +\n\t\t\t\t\terror_message +\n\t\t\t\t\t'</div>'\n\t\t\t);\n\t\t\twc_bluesnap_payment_request.unblockForm();\n\n\t\t\tvar scroll_element = $(\n\t\t\t\t'.woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout'\n\t\t\t);\n\t\t\tif ( ! scroll_element.length ) {\n\t\t\t\tscroll_element = $( form );\n\t\t\t}\n\t\t\t$.scroll_to_notices( scroll_element );\n\n\t\t\t$( document.body ).trigger( 'checkout_error' );\n\t\t},\n\n\t\tgetErrorMessage: function ( errorCode ) {\n\t\t\tlet errorMessage =\n\t\t\t\t( woocommerce_bluesnap_payment_request_params.i18n[\n\t\t\t\t\twc_bluesnap_payment_request.type\n\t\t\t\t]\n\t\t\t\t\t? woocommerce_bluesnap_payment_request_params.i18n[\n\t\t\t\t\t\t\twc_bluesnap_payment_request.type\n\t\t\t\t\t  ][ errorCode ]\n\t\t\t\t\t: false ) ||\n\t\t\t\twoocommerce_bluesnap_payment_request_params.i18n[ errorCode ] ||\n\t\t\t\tnull;\n\n\t\t\tif ( ! errorMessage ) {\n\t\t\t\terrorMessage =\n\t\t\t\t\t'An unknown error prevented the payment method from loading (' +\n\t\t\t\t\twc_bluesnap_payment_request.type +\n\t\t\t\t\t':' +\n\t\t\t\t\terrorCode +\n\t\t\t\t\t')';\n\t\t\t}\n\n\t\t\treturn errorMessage;\n\t\t},\n\t};\n\n\t// On Checkout form.\n\t$( document.body ).on( 'updated_checkout', function () {\n\t\twc_bluesnap_payment_request.init();\n\t} );\n\n\t$( wc_bluesnap_payment_request.init ); // on ready\n} )( jQuery );\n\n//# sourceMappingURL=../../source/_maps/js/frontend/woocommerce-bluesnap-payment-request.js.map\n"],"names":["$","wc_bluesnap_payment_request","type","initialized","session","source","woocommerce_bluesnap_payment_request_params","request_info_source","googlePayParams","baseRequest","apiVersion","apiVersionMinor","allowedCardNetworks","allowedCardAuthMethods","init","getSupportedPaymentRequestType","length","cart_compatible","showError","getErrorMessage","cartCompatibleWithCurrentType","createButton","show","loadJS","document","body","on","src","callback","script","createElement","onload","head","appendChild","ApplePaySession","canMakePayments","attr","html","appendTo","applePayClicked","paymentsClient","googlePayGetPaymentsClient","isReadyToPayRequest","Object","assign","allowedPaymentMethods","googlePayGetBaseCardPaymentMethod","isReadyToPay","then","response","result","googlePayCreateButton","catch","err","console","error","googlePayGetCardPaymentMethod","tokenizationSpecification","parameters","gateway","gatewayMerchantId","merchant_id","allowedAuthMethods","googlePayInit","paymentDataRequest","paymentsClientRequest","environment","test_mode","merchantInfo","merchantName","merchant_soft_descriptor","merchantId","google_pay_merchant_id","paymentDataCallbacks","onPaymentAuthorized","googlePayPaymentAuthorized","shippingAddressRequired","onPaymentDataChanged","googlePayOnPaymentDataChanged","google","payments","api","PaymentsClient","intermediatePaymentData","Promise","resolve","reject","let","shippingAddress","shippingOptionData","paymentDataRequestUpdate","selectedShippingOptionId","callbackTrigger","id","newTransactionInfo","googlePayCalculateNewTransactionInfo","newShippingOptionParameters","transformShippingForGpay","shippingMethods","intent","reason","message","shippingOptions","forEach","push","shippingMethod","identifier","label","amount","description","detail","defaultSelectedOptionId","shippingOptionId","updateShippingMethod","getShippingOptions","button","onClick","googlePayClicked","getElementById","window","apple_pay_enabled","PaymentRequest","google_pay_enabled","undefined","supportsVersion","parseInt","version_required","e","preventDefault","googlePayGetPaymentDataRequest","loadPaymentData","request","getRequestData","cardPaymentMethod","billingAddressInfo","transactionInfo","shippingAddressInfo","callbackIntents","shippingOptionRequired","concat","emailRequired","blockForm","apple_session","unblockForm","onvalidatemerchant","applePayValidateMerchant","onshippingcontactselected","applePayUpdateShippingInfo","onshippingmethodselected","applePayUpdateShippingMethod","onpaymentauthorized","applePayPaymentAuthorized","oncancel","handleCancel","begin","alert","event","ajax","url","getAjaxUrl","method","dataType","data","security","nonces","create_apple_wallet","validation_url","validationURL","payment_request_type","payment_request_source","res","decoded_token","success","atob","walletToken","completeMerchantValidation","JSON","parse","handleError","address","ret","async","get_shipping_options","btoa","unescape","encodeURIComponent","stringify","done","errorCode","fail","shippingContact","completeShippingContactSelection","status","STATUS_SUCCESS","newShippingMethods","newLineItems","lineItems","newTotal","total","ApplePayError","STATUS_FAILURE","errors","completeShippingMethodSelection","update_shipping_method","doReject","errorMessage","paymentRequestPaymentAuthorized","payment","resolveFn","handleWCResponse","onSuccess","onError","paymentToken","_wpnonce","checkout","payment_token","replace","match","p1","String","fromCharCode","is_change_payment_method","change_payment_page","wc_ajax_url","toString","get_payment_request","completePayment","trigger","handleSuccess","transactionState","redirect","indexOf","location","decodeURI","reload","refresh","messages","div","innerHTML","textContent","innerText","trim","getForm","form","closest","addClass","block","overlayCSS","background","opacity","removeClass","unblock","error_message","scroll_element","remove","prepend","scroll_to_notices","i18n","jQuery"],"mappings":"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"}